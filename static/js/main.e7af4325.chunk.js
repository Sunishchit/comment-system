(this["webpackJsonpcomment-System"]=this["webpackJsonpcomment-System"]||[]).push([[0],{17:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(1),a=n.n(r),i=n(9),o=n.n(i),s=n(8),m=n(10),u=n(4),d=function(e){var t=e.handleSubmit,n=e.submitLabel,a=e.hasCancelButton,i=void 0!==a&&a,o=e.handleCancel,s=e.initialText,m=void 0===s?"":s,d=Object(r.useState)(m),l=Object(u.a)(d,2),b=l[0],j=l[1],f=0===b.length;return Object(c.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t(b),j("")},children:[Object(c.jsx)("textarea",{className:"comment-form-textarea",value:b,onChange:function(e){return j(e.target.value)}}),Object(c.jsx)("button",{className:"comment-form-button",disabled:f,children:n}),i&&Object(c.jsx)("button",{type:"button",className:"comment-form-button comment-form-cancel-button",onClick:o,children:"Cancel"})]})},l=function e(t){var n=t.comment,r=t.replies,a=t.setActiveComment,i=t.activeComment,o=t.updateComment,s=t.deleteComment,m=t.addComment,u=t.parentId,l=void 0===u?null:u,b=t.currentUserId,j=i&&i.id===n.id&&"editing"===i.type,f=i&&i.id===n.id&&"replying"===i.type,h=new Date-new Date(n.createdAt)>3e5,p=b===n.userId&&0===r.length&&!h,O=Boolean(b),v=b===n.userId&&!h,x=l||n.id,y=new Date(n.createdAt).toLocaleDateString();return Object(c.jsxs)("div",{className:"comment",children:[Object(c.jsx)("div",{className:"comment-image-container",children:Object(c.jsx)("img",{src:"/user-icon.png"})}),Object(c.jsxs)("div",{className:"comment-right-part",children:[Object(c.jsxs)("div",{className:"comment-content",children:[Object(c.jsx)("div",{className:"comment-author",children:n.username}),Object(c.jsx)("div",{children:y})]}),!j&&Object(c.jsx)("div",{className:"comment-text",children:n.body}),j&&Object(c.jsx)(d,{submitLabel:"Update",hasCancelButton:!0,initialText:n.body,handleSubmit:function(e){return o(e,n.id)},handleCancel:function(){a(null)}}),Object(c.jsxs)("div",{className:"comment-actions",children:[O&&Object(c.jsx)("div",{className:"comment-action",onClick:function(){return a({id:n.id,type:"replying"})},children:"Reply"}),v&&Object(c.jsx)("div",{className:"comment-action",onClick:function(){return a({id:n.id,type:"editing"})},children:"Edit"}),p&&Object(c.jsx)("div",{className:"comment-action",onClick:function(){return s(n.id)},children:"Delete"})]}),f&&Object(c.jsx)(d,{submitLabel:"Reply",handleSubmit:function(e){return m(e,x)}}),r.length>0&&Object(c.jsx)("div",{className:"replies",children:r.map((function(t){return Object(c.jsx)(e,{comment:t,setActiveComment:a,activeComment:i,updateComment:o,deleteComment:s,addComment:m,parentId:n.id,replies:[],currentUserId:b},t.id)}))})]})]},n.id)},b=n(2),j=n.n(b),f=n(5),h=function(){var e=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[{id:"1",body:"First comment",username:"Jack",userId:"1",parentId:null,createdAt:(new Date).toISOString()},{id:"2",body:"Second comment",username:"John",userId:"2",parentId:null,createdAt:(new Date).toISOString()},{id:"3",body:"First comment first child",username:"John",userId:"2",parentId:"1",createdAt:(new Date).toISOString()},{id:"4",body:"Second comment second child",username:"John",userId:"2",parentId:"2",createdAt:(new Date).toISOString()}]);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Object(f.a)(j.a.mark((function e(t){var n,c=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]?c[1]:null,e.abrupt("return",{id:Math.random().toString(36).substr(2,9),body:t,parentId:n,userId:"1",username:"John",createdAt:(new Date).toISOString()});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(f.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{text:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(e){e.commentsUrl;var t=e.currentUserId,n=Object(r.useState)([]),a=Object(u.a)(n,2),i=a[0],o=a[1],b=Object(r.useState)(null),j=Object(u.a)(b,2),f=j[0],x=j[1],y=i.filter((function(e){return null===e.parentId})),C=function(e,t){p(e,t).then((function(e){o([e].concat(Object(m.a)(i))),x(null)}))},I=function(e,t){O(e).then((function(){var n=i.map((function(n){return n.id===t?Object(s.a)(Object(s.a)({},n),{},{body:e}):n}));o(n),x(null)}))},S=function(e){window.confirm("Are you sure you want to remove comment?")&&v().then((function(){var t=i.filter((function(t){return t.id!==e}));o(t)}))};return Object(r.useEffect)((function(){h().then((function(e){o(e)}))}),[]),Object(c.jsxs)("div",{className:"comments",children:[Object(c.jsx)("h3",{className:"comments-title",children:"Comments"}),Object(c.jsx)("div",{className:"comment-form-title",children:"Write comment"}),Object(c.jsx)(d,{submitLabel:"Write",handleSubmit:C}),Object(c.jsx)("div",{className:"comments-container",children:y.map((function(e){return Object(c.jsx)(l,{comment:e,replies:(n=e.id,i.filter((function(e){return e.parentId===n})).sort((function(e,t){return new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()}))),activeComment:f,setActiveComment:x,addComment:C,deleteComment:S,updateComment:I,currentUserId:t},e.id);var n}))})]})},y=function(){return Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:"Comment System"}),Object(c.jsx)(x,{commentsUrl:"http://localhost:3004/comments",currentUserId:"1"})]})};n(17);o.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(y,{})}),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.e7af4325.chunk.js.map